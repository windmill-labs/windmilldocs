import DocCard from '@site/src/components/DocCard';

# Google Cloud Storage integration

[Google Cloud Storage](https://cloud.google.com/storage) is a cloud storage service that is S3-compatible.

Instance and workspace object storage are different from using S3 resources within scripts, flows, and apps, which is free and unlimited. This is what is [described in this page](#add-a-s3-resource).

At the [workspace level](../core_concepts/38_object_storage_in_windmill/index.mdx#workspace-object-storage), what is exclusive to the [Enterprise](/pricing) version is using the integration of Windmill with S3 that is a major convenience layer to enable users to read and write from S3 without having to have access to the credentials.

Additionally, for [instance integration](../core_concepts/38_object_storage_in_windmill/index.mdx#instance-object-storage), the Enterprise version offers advanced features such as large-scale log management and distributed dependency caching.

Windmill provides a unique [resource type](https://hub.windmill.dev/resource_types/42/) for any API following the typical S3 schema.

## Add a S3 resource

Google Cloud Storage's API follows the same schema as any S3 compatible API through its S3-compatible interoperability feature.

To integrate Google Cloud Storage to Windmill, you need to save the following elements as a [resource](../core_concepts/3_resources_and_types/index.mdx).

| Property  | Type    | Description                  | Default | Required        | Where to Find                                      | Additional Details                                                                                                                                                                                |
| --------- | ------- | ---------------------------- | ------- | --------------- | -------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| bucket    | string  | GCS bucket name               |         | true            | Google Cloud Console                             | Name of the Cloud Storage bucket to access                                                                                                                                                                   |
| region    | string  | GCS region for the bucket |         | true            | Google Cloud Console                             | Region where the bucket is located. Can be found in the bucket details. In the form `us-central1`                                                                     |
| useSSL    | boolean | Use SSL for connections      | true    | false           | Google Cloud Console | SSL/TLS is required for Google Cloud Storage                                                                                                                                                                 |
| endPoint  | string  | GCS S3-compatible endpoint                  |         | true            | Google Cloud Console | For S3-compatible access, use `storage.googleapis.com`. |
| accessKey | string  | HMAC access key               |         | true for GCS | Google Cloud Console (IAM & Admin > Service Accounts)                       | HMAC access key ID. Create HMAC keys for a service account with Cloud Storage permissions in the Google Cloud Console.          |
| pathStyle | boolean | Use path-style addressing    | false   | true            | Google Cloud Console | Default is virtual-hosted-style URLs                                                                                                                                                              |
| secretKey | string  | HMAC secret key               |         | true for GCS | Google Cloud Console (IAM & Admin > Service Accounts)                       | HMAC secret access key. Generated along with the access key when creating HMAC keys for a service account.      |

<br/><br/>

### Setting up HMAC keys for Google Cloud Storage

To use Google Cloud Storage with Windmill's S3-compatible interface, you need to create HMAC keys:

1. **Navigate to the Google Cloud Console**
2. **Go to IAM & Admin > Service Accounts**
3. **Create a new service account** or select an existing one
4. **Assign the necessary roles**:
   - `Storage Object Admin` for full read/write access
   - `Storage Object Viewer` for read-only access
   - `Storage Admin` for bucket-level operations
5. **Create HMAC keys**:
   - In the service account details, go to the "HMAC keys" tab
   - Click "Create Key"
   - Save both the Access Key ID and Secret

### GCS-specific configuration

- **Endpoint**: Always use `storage.googleapis.com`
- **Region**: Use the GCS region format (e.g., `us-central1`, `europe-west1`)
- **Path Style**: Set to `false` for virtual-hosted-style URLs (recommended)
- **SSL**: Always set to `true` for secure connections

Your resource can be used [passed as parameters](../core_concepts/3_resources_and_types/index.mdx#passing-resources-as-parameters-to-scripts-preferred) or [directly fetched](../core_concepts/3_resources_and_types/index.mdx#fetching-them-from-within-a-script-by-using-the-wmill-client-in-the-respective-language) within [scripts](../script_editor/index.mdx), [flows](../flows/1_flow_editor.mdx) and [apps](../apps/0_app_editor/index.mdx).

:::tip

Find some pre-set interactions with S3 on the [Hub](https://hub.windmill.dev/integrations/s3).

Feel free to create your own S3 scripts on [Windmill](../getting_started/00_how_to_use_windmill/index.mdx).

:::

## Workspace object storage

Once you've created a Google Cloud Storage resource in Windmill, you can use Windmill's native integration with S3-compatible storage, making it the recommended storage for large objects like files and binary data.

![Workspace object storage Infographic](../core_concepts/11_persistent_storage/s3_infographics.png "Workspace object storage")

The workspace object storage is exclusive to the [Enterprise](/pricing) edition. It is meant to be a major convenience layer to enable users to read and write from GCS without having to have access to the credentials.

<div className="grid grid-cols-2 gap-6 mb-4">
	<DocCard
		title="Workspace object storage"
		description="Connect your Windmill workspace to your GCS bucket to enable users to read and write from Google Cloud Storage without having to have access to the credentials."
		href="/docs/core_concepts/object_storage_in_windmill#workspace-object-storage"
	/>
</div>

## Instance object storage

Under [Enterprise Edition](/pricing), instance object storage offers advanced features to enhance performance and scalability at the [instance](../advanced/18_instance_settings/index.mdx) level. This integration is separate from the [Workspace object storage](#workspace-object-storage) and provides solutions for large-scale log management and distributed dependency caching.

![S3/Azure for Python/Go cache & large logs](../core_concepts/20_jobs/s3_azure_cache.png "S3/Azure for Python/Go cache & large logs")

<div className="grid grid-cols-2 gap-6 mb-4">
	<DocCard
		title="Instance object storage"
		description="Connect your Windmill instance to your GCS bucket to enable distributed caching and large log storage capabilities."
		href="/docs/core_concepts/object_storage_in_windmill#instance-object-storage"
	/>
</div>