import React from 'react';
import {
	Code,
	FormInput,
	Github,
	Key,
	WebhookIcon,
	Database,
	Play,
	Terminal,
	CalendarClock,
	FormInputIcon,
	FileCode,
	AlignLeftIcon,
	CurlyBracesIcon,
	FileLock2,
	Lock,
	XSquareIcon,
	DownloadIcon,
	Bot,
	MessageSquareIcon,
	Box,
	Gitlab
} from 'lucide-react';
import { SiGnubash, SiGo, SiPython, SiTypescript, SiVisualstudiocode, SiGraphql } from 'react-icons/si/index';
import { useDeveloperMode } from '../pages';

import Section from './Section';

const cards = [
	{
		title: 'VSCode extension or any IDEs',
		subtitle:
			'Develop scripts locally with your favorite code editor, preview them locally and deploy them with the CLI. VSCode extension available',
		Icon: SiVisualstudiocode,
		gridArea: 'md:col-span-2 md:row-span-3',
		href: '/docs/advanced/local_development'
	},
	{
		title: 'Version control from Github/Gitlab',
		subtitle: 'Deploy scripts from Github or Gitlab',
		Icon: Github,
		gridArea: 'md:col-span-2 md:row-span-3',
		href: '/docs/advanced/deploy_gh_gl',
		icons: [Gitlab]
	},
	{
		title: 'CLI',
		subtitle: 'Trigger, sync and monitor scripts from CLI',
		Icon: Terminal,
		gridArea: 'md:col-span-1 md:row-span-3',
		href: '/docs/advanced/cli'
	},
	{
		title: 'Lockfile',
		subtitle: 'A lockfile is generated to ensure reproducibility',
		Icon: Box,
		gridArea: 'md:col-span-1 md:row-span-3',
		href: '/docs/advanced/imports'
	},
	{
		title: 'Immutable script versions',
		subtitle: 'Every deployed script has a unique and permanent hash.',
		Icon: Lock,
		gridArea: 'md:col-span-1 md:row-span-3',
		href: '/docs/script_editor/versioning#script-hashes'
	},
	{
		title: 'Instant preview and execution',
		subtitle: 'Preview and execute scripts instantly from the editor',
		Icon: Play,
		gridArea: 'md:col-span-1 md:row-span-3',
		href: '/docs/core_concepts/instant_preview'
	}
];

const tabs = [
	{
		label: 'Polyglot',
		icon: Code,
		id: 'script',
		data: [
			{
				title: 'Typescript',
				description: '',
				icon: SiTypescript,
				caption: <div>Deno as the <a href="/docs/getting_started/scripts_quickstart/typescript" target="_blank">TypeScript</a> runtime.</div>,
				svg: '/images/typescript-code.svg',
				altText: 'Write scripts in Typescript'
			},
			{
				title: 'Python',
				description: '',
				icon: SiPython,
				caption: <div><a href="/docs/getting_started/scripts_quickstart/python" target="_blank">Python</a>  3.11 environment.</div>,
				imageSrc: '/images/python-code.png',
				altText: 'Write scripts in Python'
			},
			{
				title: 'Go',
				icon: SiGo,
				caption: <div>Script in <a href="/docs/getting_started/scripts_quickstart/go" target="_blank">Go</a>.</div>,
				svg: '/images/go-code.svg',
				altText: 'Write scripts in Go'
			},
			{
				title: 'Bash',
				icon: SiGnubash,
				caption: <div>Script in <a href="/docs/getting_started/scripts_quickstart/bash" target="_blank">Bash</a>.</div>,
				svg: '/images/bash-code.svg',
				altText: 'Write scripts in Bash'
			},
			{
				title: 'Rest / GraphQL',
				icon: SiGraphql,
				caption: <div>Script in <a href="/docs/getting_started/scripts_quickstart/rest_graphql" target="_blank">Rest / GraphQL</a>.</div>,
				imageSrc: '/images/graphql-code.png',
				altText: 'Write scripts in Rest & GraphQL'
			},
			{
				title: 'PostgreSQL / MySQL / BigQuery / Snowflake',
				icon: Database,
				caption: <div>Script in <a href="/docs/getting_started/scripts_quickstart/sql" target="_blank">PostgreSQL / MySQL / BigQuery / Snowflake</a>.</div>,
				imageSrc: '/images/sql-code.png',
				altText: 'Write scripts in PostgreSQL / MySQL / BigQuery / Snowflake'
			},
		]
	},
	{
		label: 'Autogenerated UI & Dependencies',
		icon: FormInputIcon,
		id: 'autogenerated-ui',
		data: [
			{
				title: 'Autogenerated UI',
				description:
					"Share your app with non-technical users without spending time building the UI. It's automatically generated from script parameters, and customizable.",
				icon: FormInputIcon,
				caption: <div>Adding a new parameter to your script will automatically add a new field to the <a href="/docs/core_concepts/auto_generated_uis" target="_blank">UI</a>.</div>,
				video: {
					videoSrc: '/videos/auto_g_ui_landing.mp4',
					videoLength: '26',
					altText: 'Autogenerated UI'
				}
			},
			{
				title: 'Automatic Dependency Management',
				description:
					'Windmill automatically infers your dependencies and generate lockfiles to guarantee reproducible execution. Dependencies are cached for instant executions.',
				icon: DownloadIcon,
				imageSrc: '/images/dependencies.png',
				height: '600px',
				caption: <div>Infer <a href="/docs/advanced/imports" target="_blank">dependencies</a> from your imports.</div>,

			}
		]
	},
	{
		label: 'Web IDE',
		icon: FileCode,
		id: 'web-ide-github-sync',
		data: [
			{
				title: 'Web IDE & Assistants',
				description: 'LSP support for Typescript, Python, Go, Bash and SQL scripts.',
				icon: AlignLeftIcon,
				imageSrc: '/images/code_editor_script.png',
				altText: 'Web IDE',
				caption: <div>Windmill embeds a <a href="/docs/code_editor" target="_blank">code editor</a> and <a href="/docs/code_editor/assistants" target="_blank">code assistants</a> within its script, flow and app editors.</div>,

			},
			{
				title: 'Parameter Inference',
				description: 'Windmill employs JSON Schema to validate and align the format and type of parameters across scripts, flows, and resources.',
				icon: CurlyBracesIcon,
				video: {
					videoSrc: '/videos/parameter_inference.mp4',
					altText: 'Parameter Inference'
				},
				altText: 'Parameter Inference',
				caption: <div>JSON Schema is used behind the scenes to construct a comprehensive specification of the expected <a href="/docs/code_editor/parameter_inference" target="_blank">input parameters</a>.</div>,
			},
			{
				title: 'Add Resources and Variables to Code',
				description: 'You can directly access Variables and Resources from the Code Editor by fetching it or using the auto-generated UI.',
				icon: XSquareIcon,
				video: {
					videoSrc: '/videos/add_resources_variables.mp4',
					altText: 'Add Resources and Variables to Code'
				},
				altText: 'Add Resources and Variables to Code',
				caption: <div>You can directly <a href="/docs/code_editor/add_variables_resources" target="_blank">access Variables and Resources</a> from the Code Editor by fetching it or using the auto-generated UI.</div>,
			},
			{
				title: 'Windmill AI',
				description: 'From simple prompts, generate Windmill-specific code, edits and fixes.',
				icon: Bot,
				video: {
					videoSrc: '/videos/ai_generation.mp4',
					altText: 'Add Resources and Variables to Code'
				},
				altText: 'Windmill AI',
				caption: <div>Windmill provides ways to have <a href="/docs/core_concepts/ai_generation" target="_blank">Code Generation</a> help you in your coding experience.</div>,
			},
		]
	},
	{
		label: 'Secrets & Permissions',
		icon: Key,
		id: 'secrets-permissions',
		data: [
			{
				title: 'Secret management',
				description:
					'Credentials and sensitive values are tightly permissioned and stored securely as secrets.',
				icon: Key,
				caption: <div>Credentials and sensitive values are tightly permissioned and stored securely as <a href="/docs/core_concepts/variables_and_secrets#secrets" target="_blank">secrets</a>.</div>,
				imageSrc: '/images/script-secret.png',
				altText: 'Secret management'
			},
			{
				title: 'Permissions',
				description: 'Granular permisioning through the use of folders.',
				icon: FileLock2,
				caption: <div>Granular permisioning through the use of <a href="/docs/core_concepts/groups_and_folders" target="_blank">folders</a>.</div>,
				imageSrc: '/images/script-permissions.png',
				altText: 'Permissions'
			}
		]
	},
	{
		label: 'Schedules & Triggers',
		icon: Play,
		id: 'schedules-webhooks-ui-cli',
		data: [
			{
				title: 'Schedules',
				description:
					'Windmill allows you to define schedules for Scripts and Flows. Once a schedule is defined, it will automatically run the script at the set frequency.',
				icon: CalendarClock,
				caption: <div>Windmill allows you to define <a href="/docs/core_concepts/scheduling" target="_blank">schedules</a> for Scripts and Flows. Once a schedule is defined, it will automatically run the script at the set frequency.</div>,
				imageSrc: '/images/script-schedule.png',
				altText: 'Schedules'
			},

			{
				title: 'UI',
				description: 'You can directly trigger a script using the autogenerated UI or Windmill Apps.',
				icon: FormInput,
				caption: <div>You can directly trigger a script using the <a href="/docs/core_concepts/auto_generated_uis" target="_blank">autogenerated UI</a> or <a href="/docs/getting_started/apps_quickstart" target="_blank">Windmill Apps</a>.</div>,
				video: {
					videoSrc: '/videos/auto_generated_uis.mp4',
					videoLength: '26',
					altText: 'Autogenerated UI'
				}
			},
			{
				title: 'Webhooks',
				description: 'You can trigger a script using a webhook.',
				icon: WebhookIcon,
				caption: <div>Every script has a sync and async <a href="/docs/core_concepts/webhooks" target="_blank">webhook</a> generated for every version of the script.</div>,
				imageSrc: '/images/script-webhook.png',
				altText: 'Webhooks'
			},
			{
				title: 'CLI',
				description: 'Execute a script using the CLI.',
				icon: Terminal,
				caption: <div>Execute a script using the <a href="/docs/advanced/cli" target="_blank">CLI</a>.</div>,
				video: {
					videoSrc: 'https://www.youtube.com/embed/w2HVTlR2QDI?vq=hd1080',
					videoLength: '26',
					altText: 'Execute using CLI'
				},
				altText: 'Execute using CLI'
			},
			{
				title: 'Slack',
				description: 'Run scripts from a Slack command.',
				icon: MessageSquareIcon,
				caption: <div>Trigger scripts from commands and approve flows directly from <a href="/docs/integrations/slack" target="_blank">Slack</a>.</div>,
				imageSrc: '/images/slack-trigger.png'
			}
		]
	}
];

declare global {
	interface Window {
		plausible: (name: string) => void;
	}
}

const examples = [
	{
		name: <span>Slack messaging</span>,
		description: (
			<>
				Send message to a specific channel on{' '}
				<a
					href="https://hub.windmill.dev/integrations/slack"
					target="_blank"
					className="!no-underline"
				>
					<mark className="leading-none bg-pink-100 hover:bg-pink-200 px-2 rounded whitespace-nowrap  text-[#611f69] font-semibold">
						Slack
					</mark>
				</a>
			</>
		),
		href: 'https://hub.windmill.dev/scripts/slack/1284/send-message-to-channel-slack'
	},
	{
		name: 'Generate image using OpenAI',
		description: (
			<>
				Given a prompt, generate an image using{' '}
				<a
					href="https://hub.windmill.dev/integrations/slack"
					target="_blank"
					className="!no-underline"
				>
					<mark className="leading-none bg-purple-100 hover:bg-purple-200 px-2 rounded whitespace-nowrap  text-purple-800 font-semibold">
						OpenAI
					</mark>
				</a>
			</>
		),
		href: 'https://hub.windmill.dev/scripts/openai/1451/generate-image-openai'
	},
	{
		name: 'Search documents in MongoDB',
		description: (
			<>
				Selects documents in a{' '}
				<a
					href="https://hub.windmill.dev/scripts/mongodb/839/search-documents-mongodb"
					target="_blank"
					className="!no-underline"
				>
					<mark className="leading-none bg-green-100 hover:bg-green-200 px-2 rounded whitespace-nowrap  text-green-800 font-semibold">
						MongoDB
					</mark>
				</a>{' '}
				collection or view and returns a cursor to the selected documents
			</>
		),
		href: 'https://hub.windmill.dev/scripts/mongodb/839/search-documents-mongodb'
	}
];

export default function ScriptSection() {
	const { developerMode } = useDeveloperMode();

	return (
		<Section
			title="Scripts"
			caption={
				!developerMode
					? 'Code to production in minutes'
					: 'No overhead, scalable, self-hostable FaaS'
			}
			cards={cards}
			tabs={tabs}
			description={
				'Run long-running heavy background jobs, script with complex dependencies, endpoints with high rpm or simple one-off tasks without any overhead. Trigger them from a webhook or the auto-generated UI and monitor them easily.'
			}
			color="blue"
			key="script-card"
			examples={examples}
			kind="script"
		/>
	);
}
